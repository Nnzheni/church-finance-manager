<!doctype html>
<html><head>
<meta charset="utf-8"><title>Finance Report</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container my-4">
  <a class="btn btn-secondary mb-3" href="{{ url_for('dashboard') }}">Back to Dashboard</a>
  <h3>Finance Report</h3>
  <form class="row g-2 mb-3">
    <div class="col-md-3">
      <select name="department" class="form-select">
        <option value="">-- All Accounts & Depts --</option>
      </select>
    </div>
    <div class="col-md-3"><input type="date" name="from_date" class="form-control" value="{{ from_date }}"></div>
    <div class="col-md-3"><input type="date" name="to_date" class="form-control" value="{{ to_date }}"></div>
    <div class="col-md-3"><button class="btn btn-primary">Apply Filters</button></div>
  </form>

  <div class="mb-3">
    <a class="btn btn-success" href="{{ url_for('export_excel', department=department_filter, from_date=from_date, to_date=to_date) }}">Export to Excel</a>
    <a class="btn btn-danger" href="{{ url_for('export_pdf', department=department_filter, from_date=from_date, to_date=to_date) }}">Export to PDF</a>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered">
      <thead><tr><th>Date</th><th>Account / Dept</th><th>Type</th><th>Description</th><th class="text-end">Amount (R)</th></tr></thead>
      <tbody>
        {% if data %}
          {% for r in data %}
            <tr>
              <td>{{ r.date }}</td>
              <td>{{ r.account or r.department }}</td>
              <td>{{ r.type }}</td>
              <td>{{ r.description }}</td>
              <td class="text-end">R{{ '%.2f'|format(r.amount) }}</td>
            </tr>
          {% endfor %}
        {% else %}
          <tr><td colspan="5" class="text-center py-4">No records found</td></tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>
</body>
</html>
